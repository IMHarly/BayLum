<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Bayesian analysis for OSL age estimation of various samples — AgeS_Computation • BayLum</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Bayesian analysis for OSL age estimation of various samples — AgeS_Computation" />
<meta property="og:description" content="This function computes the age (in ka) of at least two samples
according to the model developed in Combes and Philippe (2017),
based on outputs of Generate_DataFile or Generate_DataFile_MG
or both of them using combine_DataFiles.
Samples, for which data is avalilable in several BIN files, can be analysed.
Single-grain or Multi-grain OSL measurements can be analysed simultaneouly." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">BayLum</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.2.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home"></span>
     
    Home
  </a>
</li>
<li>
  <a href="../articles/BayLum.html">
    <span class=" play"></span>
     
    Get Started
  </a>
</li>
<li>
  <a href="../reference/index.html">References</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="../news/index.html">
    <span class="fa fa-newspaper-o"></span>
     
    News
  </a>
</li>
<li>
  <a href="https://github.com/R-Lum/BayLum">
    <span class="fa fa-github"></span>
     
    GitHub
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Bayesian analysis for OSL age estimation of various samples</h1>
    <small class="dont-index">Source: <a href='https://github.com/crp2a/BayLum/blob/master/R/AgeS_Computation.R'><code>R/AgeS_Computation.R</code></a></small>
    <div class="hidden name"><code>AgeS_Computation.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function computes the age (in ka) of at least two samples
according to the model developed in Combes and Philippe (2017),
based on outputs of <code><a href='Generate_DataFile.html'>Generate_DataFile</a></code> or <code><a href='Generate_DataFile_MG.html'>Generate_DataFile_MG</a></code>
or both of them using <code><a href='combine_DataFiles.html'>combine_DataFiles</a></code>.<br />
Samples, for which data is avalilable in several BIN files, can be analysed.<br />
Single-grain or Multi-grain OSL measurements can be analysed simultaneouly.</p>
    </div>

    <pre class="usage"><span class='fu'>AgeS_Computation</span><span class='op'>(</span>
  <span class='va'>DATA</span>,
  <span class='va'>SampleNames</span>,
  <span class='va'>Nb_sample</span>,
  PriorAge <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.01</span>, <span class='fl'>100</span><span class='op'>)</span>, <span class='va'>Nb_sample</span><span class='op'>)</span>,
  BinPerSample <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='va'>Nb_sample</span><span class='op'>)</span>,
  SavePdf <span class='op'>=</span> <span class='cn'>FALSE</span>,
  OutputFileName <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"MCMCplot"</span>, <span class='st'>"summary"</span><span class='op'>)</span>,
  OutputFilePath <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>""</span><span class='op'>)</span>,
  SaveEstimates <span class='op'>=</span> <span class='cn'>FALSE</span>,
  OutputTableName <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"DATA"</span><span class='op'>)</span>,
  OutputTablePath <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>""</span><span class='op'>)</span>,
  THETA <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>)</span>,
  sepTHETA <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>","</span><span class='op'>)</span>,
  StratiConstraints <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>)</span>,
  sepSC <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>","</span><span class='op'>)</span>,
  LIN_fit <span class='op'>=</span> <span class='cn'>TRUE</span>,
  Origin_fit <span class='op'>=</span> <span class='cn'>FALSE</span>,
  distribution <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"cauchy"</span><span class='op'>)</span>,
  Iter <span class='op'>=</span> <span class='fl'>50000</span>,
  t <span class='op'>=</span> <span class='fl'>5</span>,
  n.chains <span class='op'>=</span> <span class='fl'>3</span>,
  jags_method <span class='op'>=</span> <span class='st'>"rjags"</span>,
  quiet <span class='op'>=</span> <span class='cn'>FALSE</span>,
  roundingOfValue <span class='op'>=</span> <span class='fl'>3</span>,
  <span class='va'>...</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>DATA</th>
      <td><p><a href='https://rdrr.io/r/base/list.html'>list</a> of objects: <code>LT</code>, <code>sLT</code>, <code>ITimes</code>, <code>dLab</code>, <code>ddot_env</code>, <code>regDose</code>, <code>J</code>, <code>K</code>, <code>Nb_measurement</code>,
provided by the function <a href='Generate_DataFile.html'>Generate_DataFile</a> or <a href='Generate_DataFile_MG.html'>Generate_DataFile_MG</a> or <a href='combine_DataFiles.html'>combine_DataFiles</a>.
<code>DATA</code> contains informations for more than one sample.
If there is stratigraphic relations between samples, informations in DATA must be ordered by order of incresing ages.
See the details section to for more informations.</p></td>
    </tr>
    <tr>
      <th>SampleNames</th>
      <td><p><a href='https://rdrr.io/r/base/character.html'>character</a> vector: names of samples. The length of this vector is equal to <code>Nb_sample</code>.</p></td>
    </tr>
    <tr>
      <th>Nb_sample</th>
      <td><p><a href='https://rdrr.io/r/base/integer.html'>integer</a>: number of samples, <code>Nb_sample&gt;1</code>.</p></td>
    </tr>
    <tr>
      <th>PriorAge</th>
      <td><p><a href='https://rdrr.io/r/base/numeric.html'>numeric</a> vector (with default): lower and upper bounds for age parameter of each sample (in ka).
Note that, <code>length(PriorAge)=2*Nb_sample</code>
and <code>PriorAge[2i-1,2i]</code> correponds to the lower and upper bounds of sample whose number ID is equal to <code>i</code>.</p></td>
    </tr>
    <tr>
      <th>BinPerSample</th>
      <td><p><a href='https://rdrr.io/r/base/integer.html'>integer</a> vector (with default): vector with the number of BIN files per sample.
The length of this vector is equal to <code>Nb_sample</code>.
<code>BinPerSample[i]</code> correponds to the number of BIN files for the sample whose number ID is equal to <code>i</code>.
For more information to fill this vector, we refer to detatils in <a href='Generate_DataFile.html'>Generate_DataFile</a> or in <a href='Generate_DataFile_MG.html'>Generate_DataFile_MG</a>.</p></td>
    </tr>
    <tr>
      <th>SavePdf</th>
      <td><p><a href='https://rdrr.io/r/base/logical.html'>logical</a> (with default): if TRUE save graphs in pdf file named <code>OutputFileName</code> in folder <code>OutputFilePath</code>.</p></td>
    </tr>
    <tr>
      <th>OutputFileName</th>
      <td><p><a href='https://rdrr.io/r/base/character.html'>character</a> (with default): name of the pdf file that will be generated by the function if <code>SavePdf = TRUE</code>;
<code>length(OutputFileName)=2</code>, see <b>PLOT OUTPUT</b> in <b>Value</b> section for more informations.</p></td>
    </tr>
    <tr>
      <th>OutputFilePath</th>
      <td><p><a href='https://rdrr.io/r/base/character.html'>character</a> (with default): path to the pdf file that will be generated by the function if <code>SavePdf</code>=TRUE.
If it is not equal to "", it must be terminated by "/".</p></td>
    </tr>
    <tr>
      <th>SaveEstimates</th>
      <td><p><a href='https://rdrr.io/r/base/logical.html'>logical</a> (with default): if TRUE save Bayes estimates, credible interval at level 68% and 95%  and
the result of the gelman en Rubin test of convergency, in a csv table named <code>OutputFileName</code> in folder <code>OutputFilePath</code>.</p></td>
    </tr>
    <tr>
      <th>OutputTableName</th>
      <td><p><a href='https://rdrr.io/r/base/character.html'>character</a> (with default): name of the table that will be generated by the function if <code>SaveEstimates = TRUE</code>.</p></td>
    </tr>
    <tr>
      <th>OutputTablePath</th>
      <td><p><a href='https://rdrr.io/r/base/character.html'>character</a> (with default): path to the table that will be generated by the function if <code>SaveEstimates = TRUE</code>.
If it is not equal to "", it must be terminated by "/".</p></td>
    </tr>
    <tr>
      <th>THETA</th>
      <td><p><a href='https://rdrr.io/r/base/numeric.html'>numeric</a> <a href='https://rdrr.io/r/base/matrix.html'>matrix</a> or <a href='https://rdrr.io/r/base/character.html'>character</a> (with default): input object for systematic and individual error.
If systematic errors are considered, see the details section for instructions regarding how to correctly fill <code>THETA</code>;
the user can refer to a matrix (numeric matrix) or to a csv file (character).
Otherwise, default value is suitable, and only individual errors are considered.</p></td>
    </tr>
    <tr>
      <th>sepTHETA</th>
      <td><p><a href='https://rdrr.io/r/base/character.html'>character</a> (with default): if <code>THETA</code> is character,
indicate column separator in <code>THETA</code> CSV-file.</p></td>
    </tr>
    <tr>
      <th>StratiConstraints</th>
      <td><p>numeric matrix or character(with default): input object for the statigraphic relation between samples.
If there is stratigraphic relation between samples see the details section for instructions regarding how to correctly fill
<code>StratiConstraints</code>; the user can refer to a matrix (numeric matrix) or to a csv file (character).
If there is no stratigraphic relation default value is suitable.</p></td>
    </tr>
    <tr>
      <th>sepSC</th>
      <td><p><a href='https://rdrr.io/r/base/character.html'>character</a> (with default): if <code>StratiConstraints</code> is character,
indicate column separator in <code>StratiConstraints</code> .csv file.</p></td>
    </tr>
    <tr>
      <th>LIN_fit</th>
      <td><p><a href='https://rdrr.io/r/base/logical.html'>logical</a> (with default): if TRUE (default) allows a linear component,
on top of the (default) saturating exponential curve, for the fitting of dose response curves.
See details section for more informations on the proposed dose response curves.</p></td>
    </tr>
    <tr>
      <th>Origin_fit</th>
      <td><p><a href='https://rdrr.io/r/base/logical.html'>logical</a> (with default): if TRUE, forces the dose response curves to pass through the origin.
See details section for more informations on the proposed growth curves.</p></td>
    </tr>
    <tr>
      <th>distribution</th>
      <td><p><a href='https://rdrr.io/r/base/character.html'>character</a> (with default): type of distribution that defines
how individual equivalent dose values are distributed around the palaeodose.
Allowed inputs are <b>"cauchy"</b>, <b>"gaussian"</b>, <b>"lognormal_A"</b> and <b>"lognormal_M"</b>,
see details section for more informations.</p></td>
    </tr>
    <tr>
      <th>Iter</th>
      <td><p><a href='https://rdrr.io/r/base/integer.html'>integer</a> (with default): number of iterations for the MCMC computation (for more information see <code>jags.model</code>).
If <code>jags_method = "rjparalle"</code> this number is limited to <code>1000</code> (it will be automatically adapated).</p></td>
    </tr>
    <tr>
      <th>t</th>
      <td><p><a href='https://rdrr.io/r/base/integer.html'>integer</a> (with default): 1 every <code>t</code> iterations of the MCMC is considered for sampling the posterior distribution
(for more information see <code>jags.model</code>).</p></td>
    </tr>
    <tr>
      <th>n.chains</th>
      <td><p><a href='https://rdrr.io/r/base/integer.html'>integer</a> (with default): number of independent chains for the model (for more information see <code>jags.model</code>).</p></td>
    </tr>
    <tr>
      <th>jags_method</th>
      <td><p><a href='https://rdrr.io/r/base/character.html'>character</a> (with default): select computation method, supported are  <code>"rjags"</code> (the default) and <code>rjparallel</code>
using package 'runjags'. The latter option uses the function <a href='https://rdrr.io/pkg/runjags/man/autorun.jags.html'>runjags::autorun.jags</a> to allow a full automated processing.</p></td>
    </tr>
    <tr>
      <th>quiet</th>
      <td><p><a href='https://rdrr.io/r/base/logical.html'>logical</a> (with default): enables/disables <code>rjags</code> messages</p></td>
    </tr>
    <tr>
      <th>roundingOfValue</th>
      <td><p><a href='https://rdrr.io/r/base/integer.html'>integer</a> (with default):  Integer indicating the number of decimal places to be used, default = 3.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>further arguments that can be passed to control the Bayesian process, see details
for supported arguments</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p><strong>NUMERICAL OUTPUT</strong></p>
<ol>
<li><p><strong>A list of type <code>BayLum.list</code> containing the following objects:</strong></p><ul>
<li><p><b>Sampling</b>: that corresponds to a sample of the posterior distributions
of the age (in ka), palaeodose (in Gy) and equivalent dose dispersion (in Gy) parameters for each sample;</p></li>
<li><p><b>Model_GrowthCurve</b>: stating which dose response fitting option was chosen;</p></li>
<li><p><b>Distribution</b>: stating which distribution was chosen to model the dispersion of
individual equivalent dose values around the palaeodose of the sample;</p></li>
<li><p><b>PriorAge</b>: stating the priors used for the age parameter (in ka);</p></li>
<li><p><b>StratiConstraints</b>: stating the stratigraphic relations between samples considered in the model;</p></li>
<li><p><b>CovarianceMatrix</b>: stating the covariance matrix of error used in the model, highlighting common errors between samples or not.</p></li>
</ul></li>
<li><p><b>The Gelman and Rubin test of convergency</b>: prints the result of the Gelman and Rubin test of convergency for
the age, palaeodose and equivalent dose dispersion parameters for each sample.
A result close to one is expected.<br />
In addition, the user must visually assess the convergency of the trajectories by looking at the graph
generated by the function (see <b>PLOT OUTPUT</b> for more informations).<br />
If both convergencies (Gelman and Rubin test and plot checking) are satisfactory,
the user can consider the estimates as valid.
Otherwise, the user may try increasing the number of MCMC interations (<code>Iter</code>)
or being more precise on the <code>PriorAge</code> parameter (for example specify if it is a young sample <code><a href='https://rdrr.io/r/base/c.html'>c(0.01,10)</a></code> an old sample <code><a href='https://rdrr.io/r/base/c.html'>c(10,100)</a></code>),
or changing the parameter <code>distribution</code> or the growth curve, to reach convergency.</p></li>
<li><p><b>Credible intervals and Bayes estimates</b>: prints the Bayes esitmates, the credible intervals at 95% and 68% for
the age, palaeodose and equivalent dose dispersion parameters for each sample.</p></li>
</ol>

<p><strong>PLOT OUTPUT</strong></p>
<ol>
<li><p><b>MCMC trajectories</b>: A graph with the MCMC trajectories and posterior distributions of the age, palaeodose and equivalent dose dispersion parameters
is displayed, there is one page per sample. <br />
The first line of the figure correponds to the age parameter, the second to the palaeodose parameter
and the third to the equivalent dose dispersion parameter.
On each line, the plot on the left represents the MCMC trajectories, and the one on the right the posterior distribution of the parameter.</p></li>
<li><p><b>Summary of sample age estimates</b>: plot credible intervals and Bayes estimate of each sample age on a same graph.</p></li>
</ol>

<p>To give the results in a publication, we recommend to give the Bayes estimate of the parameters as well as the credible interval at 95% or 68%.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p><strong>Supported <code>...</code> arguments</strong></p><table class='table'>
<tr><td>ARGUMENT</td><td>INPUT</td><td>METHOD</td><td>DEFAULT</td><td>DESCRIPTION</td></tr>
<tr><td><code>max.time</code></td><td><a href='https://rdrr.io/r/base/character.html'>character</a></td><td><code>rjparallel</code></td><td><code>Inf</code></td><td>maximum allowed processing time, e.g.,
<code>10m</code> for 10 minutes (cf. <a href='https://rdrr.io/pkg/runjags/man/autorun.jags.html'>runjags::autorun.jags</a>)</td></tr>
<tr><td><code>interacitve</code></td><td><a href='https://rdrr.io/r/base/logical.html'>logical</a></td><td><code>rjparallel</code></td><td><code>FALSE</code></td><td>enable/disable interactive mode (cf. <a href='https://rdrr.io/pkg/runjags/man/autorun.jags.html'>runjags::autorun.jags</a>)</td></tr>
<tr><td><code>startburnin</code></td><td><a href='https://rdrr.io/r/base/integer.html'>integer</a></td><td><code>rjparallel</code></td><td><code>4000</code></td><td>number of burnin iterations (cf. <a href='https://rdrr.io/pkg/runjags/man/autorun.jags.html'>runjags::autorun.jags</a>)</td></tr>
<tr><td><code>startsample</code></td><td><a href='https://rdrr.io/r/base/integer.html'>integer</a></td><td><code>rjparallel</code></td><td><code>10000</code></td><td>total number of samples to assess convergence
(cf. <a href='https://rdrr.io/pkg/runjags/man/autorun.jags.html'>runjags::autorun.jags</a>)</td></tr>
</table>


<p><strong>How to fill <code>StratiConstraints</code></strong><br /></p>
<p>If there is stratigraphic relations between samples,
<em>informations in DATA must be ordered by order of increasing ages</em>.
To do this the user can either fill right <code>Names</code> in <a href='Generate_DataFile.html'>Generate_DataFile</a>
or in <a href='Generate_DataFile_MG.html'>Generate_DataFile_MG</a> (as it is indicated in Details section of these function),
or ordered by order of increasing ages outputs of <a href='Generate_DataFile.html'>Generate_DataFile</a>
or <a href='Generate_DataFile_MG.html'>Generate_DataFile_MG</a> in <a href='combine_DataFiles.html'>combine_DataFiles</a></p>
<p>The user can fill the <code>StratiConstraints</code> matrix as follow.</p><ol>
<li><p><b>Size of the matrix</b>: row number of <code>StratiConstraints</code> matrix is equal to <code>Nb_sample+1</code>,
and column number is equal to <code>Nb_sample</code>.</p></li>
<li><p><b>First line of the matrix</b>:
for all <code>i in {1,...,Nb_Sample}</code>, <code>StratiConstraints[1,i]=1</code> that means the lower bound of the sample age (given in <code>PriorAge[2i-1]</code>)
for the sample whose number ID is equal to <code>i</code>, is taken into account.</p></li>
<li><p><b>Sample relations</b>: for all  <code>j in {2,...,Nb_Sample+1}</code> and all <code>i in {j,...,Nb_Sample}</code>,
<code>StratiConstraints[j,i]=1</code> if sample age whose number ID is equal to <code>j-1</code> is lower than sample age whose number ID is equal to <code>i</code>.
Otherwise, <code>StratiConstraints[j,i]=0</code>.</p></li>
</ol><p>Note that <code>StratiConstraints_{2:Nb_sample+A,1:Nb_sample}</code> is a upper triangular matrix.</p>
<p>The user can also use <code><a href='SCMatrix.html'>SCMatrix</a></code> or <code><a href='SC_Ordered.html'>SC_Ordered</a></code> (if all samples are ordered) functions
to construct the <code>StratiConstraints</code> matrix.</p>
<p>The user can also refer to a csv file that containts the relation between samples as defined above.
The user must take care about the separator used in the csv file using the argument <code>sepSC</code>.<br /></p>
<p><strong>How to fill <code>THETA</code> covariance matrix concerning common and individual error?</strong><br /></p>
<p>If systematic errors are considered, the user can fill the <code>THETA</code> matrix as follow.</p><ul>
<li><p>row number of <code>THETA</code> is equal the column number, equal to <code>Nb_sample</code>.</p></li>
<li><p>For all <code>i in {1,...,Nb_sample}</code>, <code>THETA[i,i]</code> containts individual error
plus systematic error of the sample whose number ID is equal to <code>i</code>.</p></li>
<li><p>For all <code>i,j in {1,...,Nb_sample}</code> and <code>i</code> different from <code>j</code> ,
<code>THETA[i,j]</code> containts common error between samples whose number ID are equal to <code>i</code> and <code>j</code>.</p></li>
</ul><p>Note that <code>THETA[i,j]</code> is a symetric matrix.</p>
<p>The user can also refer to a .csv file that containts the errors as defined above.<br /></p>
<p>Alternatively you can use the function <a href='create_ThetaMatrix.html'>create_ThetaMatrix</a>.</p>
<p><strong>Option on growth curves</strong><br /></p>
<p>As for <code><a href='Age_Computation.html'>Age_Computation</a></code> and <code><a href='Palaeodose_Computation.html'>Palaeodose_Computation</a></code>, the user can choose from 4 dose response curves:</p><ul>
<li><p><b>Saturating exponential plus linear growth</b> (<code>AgesMultiCS2_EXPLIN</code>):</p>
<p>for all <code>x</code> in IR+, <code>f(x)=a(1-exp(-x/b))+cx+d</code>; select</p><ul>
<li><p><code>LIN_fit=TRUE</code></p></li>
<li><p><code>Origin_fit=FALSE</code></p></li>
</ul></li>
<li><p><b>Saturating exponential growth</b> (<code>AgesMultiCS2_EXP</code>):</p>
<p>for all <code>x</code> in IR+, <code>f(x)=a(1-exp(-x/b))+d</code>; select</p><ul>
<li><p><code>LIN_fit=FALSE</code></p></li>
<li><p><code>Origin_fit=FALSE</code></p></li>
</ul></li>
<li><p><b>Saturating exponential plus linear growth and fitting
through the origin</b> (<code>AgesMultiCS2_EXPLINZO</code>):</p>
<p>for all <code>x</code> in IR+, <code>f(x)=a(1-exp(-x/b))+cx</code>; select</p><ul>
<li><p><code>LIN_fit=TRUE</code></p></li>
<li><p><code>Origin_fit=TRUE</code></p></li>
</ul></li>
<li><p><b>Saturating exponential growth and fitting through the origin</b> (<code>AgesMultiCS2_EXPZO</code>):</p>
<p>for all <code>x</code> in IR+, <code>f(x)=a(1-exp(-x/b))</code>; select</p><ul>
<li><p><code>LIN_fit=FALSE</code></p></li>
<li><p><code>Origin_fit=TRUE</code></p></li>
</ul></li>
</ul>

<p><strong>Option on equivalent dose distribution around the palaeodose</strong><br /></p>
<p>The use can choose between :</p><ul>
<li><p><code>cauchy</code>: a Cauchy distribution with location parameter equal to the palaeodose of the sample;</p></li>
<li><p><code>gaussian</code>: a Gaussian distribution with mean equal to the palaeodose of the sample;</p></li>
<li><p><code>lognormal_A</code>: a log-normal distribution with mean or <b>A</b>verage equal to the palaeodose of the sample:</p></li>
<li><p><code>lognormal_M</code>: a log-normal distribution with <b>M</b>edian equal to the palaeodose of the sample.</p></li>
</ul>

    <h2 class="hasAnchor" id="note"><a class="anchor" href="#note"></a>Note</h2>

    <p>Please note that the initial values for all MCMC are currently all the same for all chains since we rely on the automatic
initial value generation of JAGS. This is not optimal and will be changed in future. However, it does not affect the quality
of the age estimates if the chains have converged.</p>
    <h2 class="hasAnchor" id="how-to-cite"><a class="anchor" href="#how-to-cite"></a>How to cite</h2>

    <p>Christophe, C., Philippe, A., Kreutzer, S., 2020. AgeS_Computation(): Bayesian analysis for OSL age estimation of various samples. In: Christophe, C., Philippe, A., Kreutzer, S., Guerin, G., 2020. BayLum: Chronological Bayesian Models Integrating Optically Stimulated. R package version 0.2.0. https://CRAN.r-project.org/package=BayLum</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Combes, Benoit and Philippe, Anne, 2017.
Bayesian analysis of multiplicative Gaussian error for multiple ages estimation in optically stimulated luminescence dating.
Quaternary Geochronology (39, 24-34)</p>
<p>Combes, B., Philippe, A., Lanos, P., Mercier, N., Tribolo, C., Guerin, G., Guibert, P., Lahaye, C., 2015.
A Bayesian central equivalent dose model for optically stimulated luminescence dating.
Quaternary Geochronology 28, 62-70. doi:10.1016/j.quageo.2015.04.001</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><a href='Generate_DataFile.html'>Generate_DataFile</a>, <a href='Generate_DataFile_MG.html'>Generate_DataFile_MG</a>, rjags, <a href='plot_MCMC.html'>plot_MCMC</a>, <a href='SCMatrix.html'>SCMatrix</a>, <a href='Age_Computation.html'>Age_Computation</a>, <a href='Palaeodose_Computation.html'>Palaeodose_Computation</a>, <a href='plot_Ages.html'>plot_Ages</a>, <a href='create_ThetaMatrix.html'>create_ThetaMatrix</a>, <a href='https://rdrr.io/pkg/runjags/man/autorun.jags.html'>runjags::autorun.jags</a></p></div>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Claire Christophe, Anne Philippe, Guillaume Guérin, Sebastian Kreutzer</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'>## load data</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>DATA1</span>,envir <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/environment.html'>environment</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>DATA2</span>,envir <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/environment.html'>environment</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>Data</span> <span class='op'>&lt;-</span> <span class='fu'><a href='combine_DataFiles.html'>combine_DataFiles</a></span><span class='op'>(</span><span class='va'>DATA2</span>,<span class='va'>DATA1</span><span class='op'>)</span>

<span class='co'>## Age computation of samples GDB5 and GDB3,</span>
<span class='va'>priorage</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>,<span class='fl'>10</span>,<span class='fl'>20</span>,<span class='fl'>60</span><span class='op'>)</span> <span class='co'># these samples are not young</span>

<span class='co'>## without common error and without stratigraphic constraints</span>
<span class='va'>Age</span> <span class='op'>&lt;-</span> <span class='fu'>AgeS_Computation</span><span class='op'>(</span>
  DATA <span class='op'>=</span> <span class='va'>Data</span>,
  Nb_sample <span class='op'>=</span> <span class='fl'>2</span>,
  SampleNames <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"GDB5"</span>,<span class='st'>"GDB3"</span><span class='op'>)</span>,
  PriorAge <span class='op'>=</span> <span class='va'>priorage</span>,
  Iter <span class='op'>=</span> <span class='fl'>50</span>,
  n.chains <span class='op'>=</span> <span class='fl'>2</span>,
  quiet <span class='op'>=</span> <span class='cn'>TRUE</span>
  <span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='warning'>Warning: Adaptation incomplete</span></div><div class='output co'>#&gt; NOTE: Stopping adaptation
#&gt; 
#&gt; </div><div class='output co'>#&gt; <span class='warning'>Warning: [plot_MCMC()] 'n.iter' out of range, reset to number of observations</span></div><div class='img'><img src='AgeS_Computation-1.png' alt='' width='700' height='433' /></div><div class='img'><img src='AgeS_Computation-2.png' alt='' width='700' height='433' /></div><div class='output co'>#&gt; 
#&gt; 
#&gt; &gt;&gt; Results of the Gelman and Rubin criterion of convergence &lt;&lt;
#&gt; ----------------------------------------------
#&gt;  Sample name:  GDB5 
#&gt; ---------------------
#&gt; 		 Point estimate Uppers confidence interval
#&gt; A_GDB5 	 1.011 		 1.167 
#&gt; D_GDB5 	 1.056 		 1.252 
#&gt; sD_GDB5 	 1.06 		 1.35 
#&gt; ----------------------------------------------
#&gt;  Sample name:  GDB3 
#&gt; ---------------------
#&gt; 		 Point estimate Uppers confidence interval
#&gt; A_GDB3 	 2.247 		 4.705 
#&gt; D_GDB3 	 2.678 		 8.627 
#&gt; sD_GDB3 	 1.272 		 2.023 
#&gt; 
#&gt; 
#&gt; ---------------------------------------------------------------------------------------------------
#&gt;  *** WARNING: The following information are only valid if the MCMC chains have converged  ***
#&gt; ---------------------------------------------------------------------------------------------------
#&gt; 
#&gt; 
#&gt; 
#&gt; &gt;&gt; Bayes estimates of Age, Palaeodose and its dispersion for each sample and credible interval &lt;&lt;
#&gt; ----------------------------------------------
#&gt;  Sample name:  GDB5 
#&gt; ---------------------
#&gt; Parameter 	 Bayes estimate 	  Credible interval 
#&gt;  A_GDB5 	 7.35 
#&gt; 						 lower bound 	 upper bound
#&gt; 				 at level 95% 	 6.373 		 8.43 
#&gt; 				 at level 68% 	 6.778 		 7.527 
#&gt; 
#&gt; Parameter 	 Bayes estimate 	  Credible interval 
#&gt;  D_GDB5 	 18.301 
#&gt; 						 lower bound 	 upper bound
#&gt; 				 at level 95% 	 17.437 		 19.503 
#&gt; 				 at level 68% 	 17.437 		 18.493 
#&gt; 
#&gt; Parameter 	 Bayes estimate 	  Credible interval 
#&gt; sD_GDB5 	 4.757 
#&gt; 						 lower bound 	 upper bound
#&gt; 				 at level 95% 	 3.897 		 5.434 
#&gt; 				 at level 68% 	 3.897 		 4.581 
#&gt; ----------------------------------------------
#&gt;  Sample name:  GDB3 
#&gt; ---------------------
#&gt; Parameter 	 Bayes estimate 	  Credible interval 
#&gt;  A_GDB3 	 45.753 
#&gt; 						 lower bound 	 upper bound
#&gt; 				 at level 95% 	 38.974 		 54.412 
#&gt; 				 at level 68% 	 37.776 		 46.313 
#&gt; 
#&gt; Parameter 	 Bayes estimate 	  Credible interval 
#&gt;  D_GDB3 	 101.408 
#&gt; 						 lower bound 	 upper bound
#&gt; 				 at level 95% 	 95.32 		 108.813 
#&gt; 				 at level 68% 	 95.32 		 101.74 
#&gt; 
#&gt; Parameter 	 Bayes estimate 	  Credible interval 
#&gt; sD_GDB3 	 14.232 
#&gt; 						 lower bound 	 upper bound
#&gt; 				 at level 95% 	 11.266 		 18.52 
#&gt; 				 at level 68% 	 13.365 		 16.253 
#&gt; 
#&gt; ----------------------------------------------</div><div class='img'><img src='AgeS_Computation-3.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'>## Age computation of samples GDB5 and GDB3,</span>
<span class='co'>## without common error, assuming GDB5 age younder than GDB3 age</span>
<span class='kw'>if</span> <span class='op'>(</span><span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'>{</span>
<span class='va'>Nb_sample</span> <span class='op'>&lt;-</span> <span class='fl'>2</span>
<span class='va'>SC</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span>
  data <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>,<span class='fl'>1</span>,<span class='fl'>0</span>,<span class='fl'>1</span>,<span class='fl'>0</span>,<span class='fl'>0</span><span class='op'>)</span>,
  ncol <span class='op'>=</span> <span class='fl'>2</span>,
  nrow <span class='op'>=</span> <span class='op'>(</span><span class='va'>Nb_sample</span><span class='op'>+</span><span class='fl'>1</span><span class='op'>)</span>,byrow <span class='op'>=</span> <span class='cn'>T</span><span class='op'>)</span>

<span class='co'>##standard</span>
<span class='va'>Age</span> <span class='op'>&lt;-</span> <span class='fu'>AgeS_Computation</span><span class='op'>(</span>
 DATA <span class='op'>=</span> <span class='va'>Data</span>,
 Nb_sample <span class='op'>=</span> <span class='va'>Nb_sample</span>,
 SampleNames <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"GDB5"</span>,<span class='st'>"GDB3"</span><span class='op'>)</span>,
 PriorAge <span class='op'>=</span> <span class='va'>priorage</span>,
 StratiConstraints <span class='op'>=</span> <span class='va'>SC</span>,
 Iter <span class='op'>=</span> <span class='fl'>10000</span>,
 quiet <span class='op'>=</span> <span class='cn'>FALSE</span>,
 jags_method <span class='op'>=</span> <span class='st'>"rjags"</span>
 <span class='op'>)</span>

<span class='co'>##parallel mode</span>
<span class='va'>Age</span> <span class='op'>&lt;-</span> <span class='fu'>AgeS_Computation</span><span class='op'>(</span>
 DATA <span class='op'>=</span> <span class='va'>Data</span>,
 Nb_sample <span class='op'>=</span> <span class='va'>Nb_sample</span>,
 SampleNames <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"GDB5"</span>,<span class='st'>"GDB3"</span><span class='op'>)</span>,
 PriorAge <span class='op'>=</span> <span class='va'>priorage</span>,
 StratiConstraints <span class='op'>=</span> <span class='va'>SC</span>,
 Iter <span class='op'>=</span> <span class='fl'>10000</span>,
 quiet <span class='op'>=</span> <span class='cn'>FALSE</span>,
 jags_method <span class='op'>=</span> <span class='st'>"rjparallel"</span>
 <span class='op'>)</span>


<span class='op'>}</span>

</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Claire Christophe, Anne Philippe, Sebastian Kreutzer, Guillaume Guerin.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


