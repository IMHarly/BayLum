<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Bayesian analysis for the OSL age estimation of one sample — Age_Computation • BayLum</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">

<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">


<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script>
<script src="../pkgdown.js"></script>
  
  
<!-- mathjax -->
<script src='https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">BayLum</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home"></span>
     
    Home
  </a>
</li>
<li>
  <a href="../articles/BayLum.html">
    <span class=" play"></span>
     
    Get Started
  </a>
</li>
<li>
  <a href="../reference/index.html">References</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="../news/index.html">
    <span class="fa fa-newspaper-o"></span>
     
    News
  </a>
</li>
<li>
  <a href="https://github.com/R-Lum/BayLum">
    <span class="fa fa-github"></span>
     
    GitHub
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

      <div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Bayesian analysis for the OSL age estimation of one sample</h1>
    </div>

    
    <p>This function computes the age (in ka) of a sample according to the model developed in Combes and Philippe (2017),
based on an output of <code><a href='Generate_DataFile.html'>Generate_DataFile</a></code> or <code><a href='Generate_DataFile_MG.html'>Generate_DataFile_MG</a></code>.
A sample, for which data is avalilable in several BIN files, can be analysed.</p>
    

    <pre class="usage"><span class='fu'>Age_Computation</span>(<span class='no'>DATA</span>, <span class='no'>SampleName</span>, <span class='kw'>PriorAge</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='fl'>0.01</span>, <span class='fl'>100</span>),
  <span class='kw'>BinPerSample</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='fl'>1</span>), <span class='kw'>SavePdf</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>OutputFileName</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='st'>"MCMCplot"</span>),
  <span class='kw'>OutputFilePath</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='st'>""</span>), <span class='kw'>SaveEstimates</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>OutputTableName</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='st'>"DATA"</span>), <span class='kw'>OutputTablePath</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='st'>""</span>), <span class='kw'>LIN_fit</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
  <span class='kw'>Origin_fit</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>distribution</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='st'>"cauchy"</span>), <span class='kw'>I</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='kw'>Iter</span> <span class='kw'>=</span> <span class='fl'>50000</span>,
  <span class='kw'>t</span> <span class='kw'>=</span> <span class='fl'>5</span>, <span class='kw'>Nb_chaines</span> <span class='kw'>=</span> <span class='fl'>3</span>, <span class='kw'>quiet</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a> Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>DATA</th>
      <td><p>list of objects: LT, sLT, ITimes, dLab, ddot_env, regDose, J, K, Nb_measurement,
provided by the function <code><a href='Generate_DataFile.html'>Generate_DataFile</a></code> or <code><a href='Generate_DataFile_MG.html'>Generate_DataFile_MG</a></code>.
<code>DATA</code> can contain informations for more than one sample.</p></td>
    </tr>
    <tr>
      <th>SampleName</th>
      <td><p>character: name of the sample.</p></td>
    </tr>
    <tr>
      <th>PriorAge</th>
      <td><p>numeric vector (with default): lower and upper bounds for the sample age parameter (in ka).
Note that, <code>length(PriorAge)=2</code>.</p></td>
    </tr>
    <tr>
      <th>BinPerSample</th>
      <td><p>integer vector (with default): vector with the number of BIN files per sample.
If in <code>DATA</code> there is more than one sample,
the <code>BinPerSample</code> vector must be the same as that used to run the function
<code><a href='Generate_DataFile.html'>Generate_DataFile</a></code> or in <code><a href='Generate_DataFile_MG.html'>Generate_DataFile_MG</a></code> for generating the <code>DATA</code> object.</p></td>
    </tr>
    <tr>
      <th>SavePdf</th>
      <td><p>boolean (with default): if TRUE save graph in pdf file named <code>OutputFileName</code> in folder <code>OutputFilePath</code>.</p></td>
    </tr>
    <tr>
      <th>OutputFileName</th>
      <td><p>character (with default): name of the pdf file that will be generated by the function if <code>SavePdf</code>=TRUE;
<code>length(OutputFileName)=2</code>, see <b>PLOT OUTPUT</b> in <b>Value</b> section for more informations.</p></td>
    </tr>
    <tr>
      <th>OutputFilePath</th>
      <td><p>character (with default): path to the pdf file that will be generated by the function if <code>SavePdf</code>=TRUE.
If it is not equal to "", it must be terminated by "/".</p></td>
    </tr>
    <tr>
      <th>SaveEstimates</th>
      <td><p>boolean (with default): if TRUE save Bayes estimates and credible interval at level 68% and 95%  and
the result of the gelman en Rubin test of convergency, in a csv table named <code>OutputFileName</code> in folder <code>OutputFilePath</code>.</p></td>
    </tr>
    <tr>
      <th>OutputTableName</th>
      <td><p>character (with default): name of the table that will be generated by the function if <code>SaveEstimates</code>=TRUE.</p></td>
    </tr>
    <tr>
      <th>OutputTablePath</th>
      <td><p>character (with default): path to the table that will be generated by the function if <code>SaveEstimates</code>=TRUE.
If it is not equal to "", it must be terminated by "/".</p></td>
    </tr>
    <tr>
      <th>LIN_fit</th>
      <td><p>logical (with default): if TRUE (default) allows a linear component,
on top of the (default) saturating exponential curve, for the fitting of dose response curves.
See details section for more informations on the proposed dose response curves.</p></td>
    </tr>
    <tr>
      <th>Origin_fit</th>
      <td><p>logical (with default): if TRUE, forces the dose response curves to pass through the origin.
See details section for more informations on the proposed growth curves.</p></td>
    </tr>
    <tr>
      <th>distribution</th>
      <td><p>character (with default): type of distribution that defines
how individual equivalent dose values are distributed around the palaeodose.
Allowed inputs are <b>"cauchy"</b>, <b>"gaussian"</b>, <b>"lognormal_A"</b> and <b>"lognormal_M"</b>, see details section for more informations.</p></td>
    </tr>
    <tr>
      <th>I</th>
      <td><p>integer (with default): if <code>DATA</code> contains data from more than one sample,
I indicates the ID number of the sample to be analysed.</p></td>
    </tr>
    <tr>
      <th>Iter</th>
      <td><p>integer (with default): number of iterations for the MCMC computation (for more information see <code>jags.model</code>).</p></td>
    </tr>
    <tr>
      <th>t</th>
      <td><p>integer (with default): 1 every <code>t</code> iterations of the MCMC is considered for sampling the posterior distribution
(for more information see <code>jags.model</code>).</p></td>
    </tr>
    <tr>
      <th>Nb_chaines</th>
      <td><p>integer (with default): number of independent chains for the model (for more information see <code>jags.model</code>).</p></td>
    </tr>
    <tr>
      <th>quiet</th>
      <td><p><code>logical</code> (with default): enables/disables rjags messages</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p><b>NUMERICAL OUTPUT</b></p><ol>
<li><p><b>A list containing the following objects</b>:</p><ul>
<li><p><b>Sampling</b> that corresponds to a sample of the posterior distributions
 of the age (in ka), palaeodose (in Gy) and equivalent dose dispersion (in Gy) parameters.</p></li>
<li><p><b>Model_GrowthCurve</b>, stating which dose response fitting option was chosen;</p></li>
<li><p><b>Distribution</b>, stating which distribution was chosen to model the dispersion of
 individual equivalent dose values around the palaeodose of the sample;</p></li>
<li><p><b>PriorAge</b>, stating the priors used for the age parameter (in ka).</p></li>
</ul></li>
<li><p><b>The Gelman and Rubin test of convergency</b>: prints the result of the Gelman and Rubin test of convergency for the age, palaeodose and equivalent dose dispersion parameters.
A result close to one is expected.
In addition, the user must visually assess the convergency of the trajectories by looking at the graph
generated by the function (see <b>PLOT OUTPUT</b> for more informations).
If both convergencies (Gelman and Rubin test and plot checking) are satisfactory,
the user can consider the printed estimates as valid. Otherwise, the user may try increasing the number of MCMC interations
(<code>Iter</code>), or being more precise on the <code>PriorAge</code> parameter (for example specify if it is a young sample <code>c(0.01,10)</code> an old sample <code>c(10,100)</code>),
or changing the parameter <code>distribution</code> or the growth curve, to reach convergency.to reach convergency.</p></li>
<li><p><b>Credible intervals and Bayes estimates</b>: prints the Bayes esitmates, the credible intervals at 95% and 68% for
the age, palaeodose and equivalent dose dispersion parameters of the sample.</p></li>
</ol><p><b>PLOT OUTPUT</b></p>
<p>A graph with the MCMC trajectories and posterior distributions of the age, palaeodose and equivalent dose dispersion parameters is displayed.
The first line of the figure correponds to the age parameter, the second to the palaeodose parameter and the third to the equivalent dose dispersion parameter.
On each line, the plot on the left represents the MCMC trajectories, and the one on the right the posterior distribution of the parameter.</p>
<p>To give the results in a publication, we recommend to give the Bayes estimate of the parameter as well as the credible interval at 95% or 68%.</p>
    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p><b>** Option on growth curves **</b></p>
<p>As for <code><a href='AgeS_Computation.html'>AgeS_Computation</a></code> and <code><a href='Palaeodose_Computation.html'>Palaeodose_Computation</a></code>, the user can choose from 4 dose response curves:</p><ul>
<li><p><b>Saturating exponential plus linear growth</b> (<code>AgeMultiBF_EXPLIN</code>):</p>
<p>for all <code>x</code> in IR+, <code>f(x)=a(1-exp(-x/b))+cx+d</code>; select</p><ul>
<li><p><code>LIN_fit=TRUE</code></p></li>
<li><p><code>Origin_fit=FALSE</code></p></li>
</ul></li>
<li><p><b>Saturating exponential growth</b> (<code>AgeMultiBF_EXP</code>):</p>
<p>for all <code>x</code> in IR+, <code>f(x)=a(1-exp(-x/b))+d</code>; select</p><ul>
<li><p><code>LIN_fit=FALSE</code></p></li>
<li><p><code>Origin_fit=FALSE</code></p></li>
</ul></li>
<li><p><b>Saturating exponential plus linear growth and fitting through the origin</b> (<code>AgeMultiBF_EXPLINZO</code>):</p>
<p>for all <code>x</code> in IR+, <code>f(x)=a(1-exp(-x/b))+cx</code>; select</p><ul>
<li><p><code>LIN_fit=TRUE</code></p></li>
<li><p><code>Origin_fit=TRUE</code></p></li>
</ul></li>
<li><p><b>Saturating exponential growth and fitting through the origin</b> (<code>AgeMultiBF_EXPZO</code>):</p>
<p>for all <code>x</code> in IR+, <code>f(x)=a(1-exp(-x/b))</code>; select</p><ul>
<li><p><code>LIN_fit=FALSE</code></p></li>
<li><p><code>Origin_fit=TRUE</code></p></li>
</ul></li>
</ul><p><b>** Option on equivalent dose distribution around the palaeodose **</b></p>
<p>The use can choose between :</p><ul>
<li><p><code>cauchy</code>: a Cauchy distribution with location parameter equal to the palaeodose of the sample</p></li>
<li><p><code>gaussian</code>: a Gaussian distribution with mean equal to the palaeodose of the sample</p></li>
<li><p><code>lognormal_A</code>: a log-normal distribution with mean or <b>A</b>verage equal to the palaeodose of the sample</p></li>
<li><p><code>lognormal_M</code>: a log-normal distribution with <b>M</b>edian equal to the palaeodose of the sample</p></li>
</ul>
    
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Combes, Benoit and Philippe, Anne, 2017.
Bayesian analysis of multiplicative Gaussian error for multiple ages estimation in optically
stimulated luminescence dating.
Quaternary Geochronology (39, 24-34)</p>
<p>Combes, B., Philippe, A., Lanos, P., Mercier, N., Tribolo, C., Guerin, G., Guibert, P., Lahaye, C., 2015.
A Bayesian central equivalent dose model for optically stimulated luminescence dating.
Quaternary Geochronology 28, 62-70. doi:10.1016/j.quageo.2015.04.001</p>
    
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <p><code><a href='Generate_DataFile.html'>Generate_DataFile</a></code>, <code><a href='Generate_DataFile_MG.html'>Generate_DataFile_MG</a></code>,
<code>rjags</code>, <code><a href='plot_MCMC.html'>plot_MCMC</a></code>
<code><a href='AgeS_Computation.html'>AgeS_Computation</a></code>, <code><a href='Palaeodose_Computation.html'>Palaeodose_Computation</a></code></p>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'>## load data file generated by the function Generate_DataFile</span>
<span class='fu'>data</span>(<span class='no'>DATA1</span>,<span class='kw'>envir</span> <span class='kw'>=</span> <span class='fu'>environment</span>())
<span class='no'>priorage</span> <span class='kw'>&lt;-</span> <span class='fu'>c</span>(<span class='fl'>10</span>,<span class='fl'>60</span>) <span class='co'># GDB3 is an old sample</span>
<span class='no'>Age</span> <span class='kw'>&lt;-</span> <span class='fu'>Age_Computation</span>(
 <span class='kw'>DATA</span> <span class='kw'>=</span> <span class='no'>DATA1</span>,
 <span class='kw'>SampleName</span> <span class='kw'>=</span> <span class='st'>"GDB3"</span>,
 <span class='kw'>PriorAge</span> <span class='kw'>=</span> <span class='no'>priorage</span>,
 <span class='kw'>Iter</span> <span class='kw'>=</span> <span class='fl'>100</span>,
 <span class='kw'>quiet</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)</div><div class='output co'>#&gt; <span class='warning'>Warning: [plot_MCMC()] 'n.iter' out of range, reset to default!</span></div><div class='output co'>#&gt; <span class='error'>Error in plot.new(): figure margins too large</span></div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#details">Details</a></li>

      <li><a href="#references">References</a></li>

      <li><a href="#see-also">See also</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

    <h2>Author</h2>
    
Claire Christophe, Sebastian Kreutzer, Anne Philippe, Guillaume Guerin

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Claire Christophe, Anne Philippe, Sebastian Kreutzer, Guillaume Guerin.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  </body>
</html>
