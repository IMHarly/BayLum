<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Bayesian analysis for age estimation of OSL measurements and C-14 ages of various samples — Age_OSLC14 • BayLum</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Bayesian analysis for age estimation of OSL measurements and C-14 ages of various samples — Age_OSLC14" />
<meta property="og:description" content="This function compute an age of OSL data of at least two samples and calibrate
C-14 ages of samples to get an age (in ka).
Age of OSL data are computed according to the model given in Combes and Philippe (2017).
Single-grain or Multi-grain OSL measurements can be analysed simultaneously
(with output of Generate_DataFile or Generate_DataFile_MG or both of them using combine_DataFiles).
Samples, for which data is available in several BIN files, can be analysed.
For C-14 data, the user can choose one of the following radiocarbon calibration curve:
Northern or Southern Hemisphere or marine atmospheric." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">BayLum</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.2.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home"></span>
     
    Home
  </a>
</li>
<li>
  <a href="../articles/BayLum.html">
    <span class=" play"></span>
     
    Get Started
  </a>
</li>
<li>
  <a href="../reference/index.html">References</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="../news/index.html">
    <span class="fa fa-newspaper-o"></span>
     
    News
  </a>
</li>
<li>
  <a href="https://github.com/R-Lum/BayLum">
    <span class="fa fa-github"></span>
     
    GitHub
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Bayesian analysis for age estimation of OSL measurements and C-14 ages of various samples</h1>
    <small class="dont-index">Source: <a href='https://github.com/crp2a/BayLum/blob/master/R/Age_OSLC14.R'><code>R/Age_OSLC14.R</code></a></small>
    <div class="hidden name"><code>Age_OSLC14.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function compute an age of OSL data of at least two samples and calibrate
C-14 ages of samples to get an age (in ka).<br />
Age of OSL data are computed according to the model given in Combes and Philippe (2017).
Single-grain or Multi-grain OSL measurements can be analysed simultaneously
(with output of <a href='Generate_DataFile.html'>Generate_DataFile</a> or <a href='Generate_DataFile_MG.html'>Generate_DataFile_MG</a> or both of them using <a href='combine_DataFiles.html'>combine_DataFiles</a>).
Samples, for which data is available in several BIN files, can be analysed.<br />
For C-14 data, the user can choose one of the following radiocarbon calibration curve:
Northern or Southern Hemisphere or marine atmospheric.</p>
    </div>

    <pre class="usage"><span class='fu'>Age_OSLC14</span><span class='op'>(</span>
  <span class='va'>DATA</span>,
  <span class='va'>Data_C14Cal</span>,
  <span class='va'>Data_SigmaC14Cal</span>,
  <span class='va'>Nb_sample</span>,
  <span class='va'>SampleNames</span>,
  <span class='va'>SampleNature</span>,
  PriorAge <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>10</span>, <span class='fl'>60</span><span class='op'>)</span>, <span class='va'>Nb_sample</span><span class='op'>)</span>,
  SavePdf <span class='op'>=</span> <span class='cn'>FALSE</span>,
  OutputFileName <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"MCMCplot"</span>, <span class='st'>"HPD_Cal14CCurve"</span>, <span class='st'>"summary"</span><span class='op'>)</span>,
  OutputFilePath <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>""</span><span class='op'>)</span>,
  SaveEstimates <span class='op'>=</span> <span class='cn'>FALSE</span>,
  OutputTableName <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"DATA"</span><span class='op'>)</span>,
  OutputTablePath <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>""</span><span class='op'>)</span>,
  StratiConstraints <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>)</span>,
  sepSC <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>","</span><span class='op'>)</span>,
  BinPerSample <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>SampleNature</span><span class='op'>[</span><span class='fl'>1</span>, <span class='op'>]</span><span class='op'>)</span><span class='op'>)</span>,
  THETA <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>)</span>,
  sepTHETA <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>","</span><span class='op'>)</span>,
  LIN_fit <span class='op'>=</span> <span class='cn'>TRUE</span>,
  Origin_fit <span class='op'>=</span> <span class='cn'>FALSE</span>,
  distribution <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"cauchy"</span><span class='op'>)</span>,
  Model_C14 <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"full"</span><span class='op'>)</span>,
  CalibrationCurve <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"IntCal20"</span><span class='op'>)</span>,
  Iter <span class='op'>=</span> <span class='fl'>50000</span>,
  t <span class='op'>=</span> <span class='fl'>5</span>,
  n.chains <span class='op'>=</span> <span class='fl'>3</span>,
  quiet <span class='op'>=</span> <span class='cn'>FALSE</span>,
  roundingOfValue <span class='op'>=</span> <span class='fl'>3</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>DATA</th>
      <td><p>list of objects: <code>LT</code>, <code>sLT</code>, <code>ITimes</code>, <code>dLab</code>, <code>ddot_env</code>, <code>regDose</code>, <code>J</code>,
<code>K</code>, <code>Nb_measurement</code>, provided by the function <a href='Generate_DataFile.html'>Generate_DataFile</a> or <a href='Generate_DataFile_MG.html'>Generate_DataFile_MG</a> or <a href='combine_DataFiles.html'>combine_DataFiles</a>.
<code>DATA</code> contains information for more than one sample.
If there is stratigraphic relations between samples, informations in DATA must be ordered by order of
increasing ages. See the details section to for more informations.</p></td>
    </tr>
    <tr>
      <th>Data_C14Cal</th>
      <td><p><a href='https://rdrr.io/r/base/numeric.html'>numeric</a> vector: corresponding to C-14 age estimate
(in years, conversion in ka is automatically done in the function).
If there is stratigraphic relations between samples, <code>Data_C14Cal</code> must be ordered
by order of increasing ages.</p></td>
    </tr>
    <tr>
      <th>Data_SigmaC14Cal</th>
      <td><p><a href='https://rdrr.io/r/base/numeric.html'>numeric</a>: corresponding to the error of C-14 age estimates.</p></td>
    </tr>
    <tr>
      <th>Nb_sample</th>
      <td><p><a href='https://rdrr.io/r/base/numeric.html'>numeric</a>: number of samples (OSL data and C-14 age),
(<code>Nb_sample&gt;3</code>, at least to sample of OSL data and one sample of C-14 age).</p></td>
    </tr>
    <tr>
      <th>SampleNames</th>
      <td><p><a href='https://rdrr.io/r/base/character.html'>character</a>: sample names for both OSL data and C14 data.
The length of this vector is equal to <code>Nb_sample</code>.
If there is stratigraphic relation, this vector must be ordered by increasing
order (to mix OSL samples and C-14 ages if it is needed).</p></td>
    </tr>
    <tr>
      <th>SampleNature</th>
      <td><p><a href='https://rdrr.io/r/base/matrix.html'>matrix</a>: states the nature of the sample.
Row number of <code>SampleNature</code> matrix is equal to <code>2</code> and column number is equal
to <code>Nb_sample</code>. First line of the matrix: <code>SampleNature[1,i]</code> states if sample
whose number ID is equal to <code>i</code>, is an OSL sample <code>1</code> or not <code>0</code>.
Second line of the matrix: <code>SampleNature[2,i]</code> states if sample whose number ID
is equal to <code>i</code>, is an C-14 sample <code>1</code> or not `0.</p></td>
    </tr>
    <tr>
      <th>PriorAge</th>
      <td><p><a href='https://rdrr.io/r/base/numeric.html'>numeric</a> (with default): lower and upper bounds for age parameter of each sample <strong>(in ka)</strong>.
Note that, <code>length(PriorAge) = 2*Nb_sample</code> sand <code>PriorAge[2i-1,2i]</code> corresponds
to the lower and upper bounds of sample whose number ID is equal to <code>i</code>.</p></td>
    </tr>
    <tr>
      <th>SavePdf</th>
      <td><p><a href='https://rdrr.io/r/base/logical.html'>logical</a> (with default): if <code>TRUE</code> save graphs in pdf file
named <code>OutputFileName</code> in folder <code>OutputFilePath</code>.</p></td>
    </tr>
    <tr>
      <th>OutputFileName</th>
      <td><p><a href='https://rdrr.io/r/base/character.html'>character</a> (with default): name of the pdf file that
will be generated by the function if <code>SavePdf=TRUE</code>, <code>length(OutputFileName)=3</code>,
see <strong>PLOT OUTPUT</strong> in <strong>Value</strong> section for more informations.</p></td>
    </tr>
    <tr>
      <th>OutputFilePath</th>
      <td><p><a href='https://rdrr.io/r/base/character.html'>character</a> (with default): path to the pdf file that will
be generated by the function if <code>SavePdf=TRUE</code>. If it is not equal to "", it must be terminated by "/".</p></td>
    </tr>
    <tr>
      <th>SaveEstimates</th>
      <td><p><a href='https://rdrr.io/r/base/logical.html'>logical</a> (with default): if TRUE save Bayes' estimates,
credible interval at level 68% and 95%  and the result of the Gelman en Rubin
test of convergence, in a CSV-table named <code>OutputFileName</code> in folder <code>OutputFilePath</code>.</p></td>
    </tr>
    <tr>
      <th>OutputTableName</th>
      <td><p><a href='https://rdrr.io/r/base/character.html'>character</a> (with default): name of the table that will
be generated by the function if <code>SaveEstimates=TRUE</code>.</p></td>
    </tr>
    <tr>
      <th>OutputTablePath</th>
      <td><p><a href='https://rdrr.io/r/base/character.html'>character</a> (with default): path to the table that will
be generated by the function if <code>SaveEstimates=TRUE</code>. If it is not equal to "",
it must be terminated by "/".</p></td>
    </tr>
    <tr>
      <th>StratiConstraints</th>
      <td><p><a href='https://rdrr.io/r/base/matrix.html'>matrix</a> or <a href='https://rdrr.io/r/base/character.html'>character</a> (with default): input object for the
stratigraphic relation between samples. If there is stratigraphic relation between
samples see the details section for instructions regarding how to correctly fill <code>StratiConstraints</code>,
the user can refer to a <a href='https://rdrr.io/r/base/matrix.html'>matrix</a> or to a CSV-file <a href='https://rdrr.io/r/base/character.html'>character</a>. Otherwise, default value is suitable.</p></td>
    </tr>
    <tr>
      <th>sepSC</th>
      <td><p><a href='https://rdrr.io/r/base/character.html'>character</a> (with default): if <code>StratiConstraints</code> is character,
indicate column separator in <code>StratiConstraints</code> CSV-file.</p></td>
    </tr>
    <tr>
      <th>BinPerSample</th>
      <td><p><a href='https://rdrr.io/r/base/numeric.html'>numeric</a> (with default): vector with the number of BIN-files
per OSL sample. The length of this vector is equal to the number of OSL samples.
<code>BinPerSample[i]</code> corresponds to the number of BIN files for the sample whose
number ID is equal to <code>i</code>.  For more information to fill this vector, we refer
to details in <a href='Generate_DataFile.html'>Generate_DataFile</a> or in <a href='Generate_DataFile_MG.html'>Generate_DataFile_MG</a>.</p></td>
    </tr>
    <tr>
      <th>THETA</th>
      <td><p>numeric <a href='https://rdrr.io/r/base/matrix.html'>matrix</a> or <a href='https://rdrr.io/r/base/character.html'>character</a> (with default): input object for
systematic and individual error for OSL samples. If systematic errors are considered,
see the details section for instructions regarding how to correctly fill <code>THETA</code>;
the user can refer to a matrix (numeric matrix) or to a csv file (character).
Otherwise, default value is suitable, and only individual error is considered.</p></td>
    </tr>
    <tr>
      <th>sepTHETA</th>
      <td><p><a href='https://rdrr.io/r/base/character.html'>character</a> (with default): if <code>THETA</code> is character,
indicate column separator in <code>THETA</code> CSV-file.</p></td>
    </tr>
    <tr>
      <th>LIN_fit</th>
      <td><p><a href='https://rdrr.io/r/base/logical.html'>logical</a> (with default): if <code>TRUE</code> (default) allows a linear component,
on top of the (default) saturating exponential curve, for the fitting of dose response curves,
for OSL samples. See details for more informations on the proposed dose response curves.</p></td>
    </tr>
    <tr>
      <th>Origin_fit</th>
      <td><p>p<a href='https://rdrr.io/r/base/logical.html'>logical</a> (with default): if <code>TRUE</code>, forces the dose response
curves to pass through the origin. See details for more informations on the proposed
growth curves, for OSL samples.</p></td>
    </tr>
    <tr>
      <th>distribution</th>
      <td><p><a href='https://rdrr.io/r/base/character.html'>character</a> (with default): type of distribution that defines
how individual equivalent dose values are distributed around the palaeodose, for OSL samples.
Allowed inputs are <code>"cauchy"</code>, <code>"gaussian"</code>, <code>"lognormal_A"</code> and <code>"lognormal_M"</code>,
see details for more informations.</p></td>
    </tr>
    <tr>
      <th>Model_C14</th>
      <td><p><a href='https://rdrr.io/r/base/character.html'>character</a> (with default): if <code>"full"</code>, error on estimate calibration
curve is taken account, for C-14 samples.  If <code>"naive"</code> this error is not taken account in the age estimate.</p></td>
    </tr>
    <tr>
      <th>CalibrationCurve</th>
      <td><p><a href='https://rdrr.io/r/base/character.html'>character</a> (with default): calibration curve chosen, for C-14 samples.
Allowed inputs are</p><ul>
<li><p><b>"Intcal13"</b> or <b>"Intcal13"</b> for Northern Hemisphere atmospheric radiocarbon calibration curve,</p></li>
<li><p><b>"Marine13"</b> or <b>"Marine13"</b> for Marine radiocarbon calibration curve,</p></li>
<li><p><b>"SHCal13"</b> or <b>"SHCal20"</b> for Southern Hemisphere atmospheric radiocarbon calibration curve</p></li>
<li><p><b>a csv file, with tree columns, the first column is dedicated to "Cal.BP", the second to "XC-14.age", the third to "Error".
The decimal of this file must be a dot, and the separator must be a comma. </b></p></li>
</ul></td>
    </tr>
    <tr>
      <th>Iter</th>
      <td><p><a href='https://rdrr.io/r/base/numeric.html'>numeric</a> (with default): number of iterations for the MCMC computation
(for more information see <a href='https://rdrr.io/pkg/rjags/man/jags.model.html'>rjags::jags.model</a>.</p></td>
    </tr>
    <tr>
      <th>t</th>
      <td><p><a href='https://rdrr.io/r/base/numeric.html'>numeric</a> (with default): 1 every <code>t</code> iterations of the MCMC is
considered for sampling the posterior distribution (for more information see [<a href='https://rdrr.io/pkg/rjags/man/jags.model.html'>rjags::jags.model</a>.</p></td>
    </tr>
    <tr>
      <th>n.chains</th>
      <td><p><a href='https://rdrr.io/r/base/numeric.html'>numeric</a> (with default): number of independent chains for the model
(for more information see [<a href='https://rdrr.io/pkg/rjags/man/jags.model.html'>rjags::jags.model</a>).</p></td>
    </tr>
    <tr>
      <th>quiet</th>
      <td><p><a href='https://rdrr.io/r/base/logical.html'>logical</a> (with default): enables/disables rjags messages</p></td>
    </tr>
    <tr>
      <th>roundingOfValue</th>
      <td><p><a href='https://rdrr.io/r/base/integer.html'>integer</a> (with default):  Integer indicating the number of decimal places to be used, default = 3.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p><b>NUMERICAL OUTPUT</b><br /></p>
<ol>
<li><p><b>A list containing the following objects:</b></p><ul>
<li><p><b>Sampling</b>: that corresponds to a sample of the posterior distributions of the age parameters (in ka for both C14 samples and OSL samples);</p></li>
<li><p><b>PriorAge</b>: stating the priors used for the age parameter;</p></li>
<li><p><b>StratiConstraints</b>: stating the stratigraphic relations between samples considered in the model;</p></li>
<li><p><b>Model_OSL_GrowthCurve</b>: stating which dose response fitting option was chosen;</p></li>
<li><p><b>Model_OSL_Distribution</b>: stating which distribution was chosen to model the dispersion of
individual equivalent dose values around the palaeodose of the sample;</p></li>
<li><p><b>Model_C14</b>: stating which model was chosen (<code>"full"</code> or <code>"naive"</code>);</p></li>
<li><p><b>CalibrationCurve</b>: stating which radiocarbon calibration curve was chosen;</p></li>
<li><p><b>Outlier</b>: stating the names of samples that must be outliers.</p></li>
</ul></li>
<li><p><b>The Gelman and Rubin test of convergency</b>: prints the result of the Gelman and Rubin test of convergence for the age estimate for each sample.
A result close to one is expected.<br />
In addition, the user must visually assess the convergence of the trajectories by looking at the graph
generated by the function (see <b>PLOT OUTPUT</b> for more informations).<br />
If both convergences (Gelman and Rubin test and plot checking) are satisfactory,
the user can consider the estimates as valid.
Otherwise, the user may try increasing the number of MCMC iterations (<code>Iter</code>)
or be more precise on the <code>PriorAge</code> parameter to reach convergence.</p></li>
<li><p><b>Credible intervals and Bayes estimates</b>: prints the Bayes' estimates, the credible intervals at 95% and 68% for
the age parameters for each sample.</p></li>
</ol>

<p><b>PLOT OUTPUT</b></p>
<ol>
<li><p><b>MCMC trajectories</b>: A graph with the MCMC trajectories and posterior distributions of the age parameter is displayed. <br />
On each line, the plot on the left represents the MCMC trajectories, and the one on the right the posterior distribution of the parameter.</p></li>
<li><p><b>Age estimate and HPD at 95% of 14C samples on calibration curve</b>: plot age estimate and HPD on calibration plot.</p></li>
<li><p><b>Summary of sample age estimates</b>: plot credible intervals and Bayes estimate of each sample age on a same graph.</p></li>
</ol>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>Note that there is tree type of arguments in the previous list.
There are arguments for information concerning only OSL samples: <code>DATA</code>, <code>BinPerSample</code>, <code>THETA</code>,
<code>sepTHETA</code>, <code>LIN_fit</code>, <code>Origin_fit</code>, <code>distribution</code>.</p>
<p>There are arguments for information concerning only C14 samples: <code>Data_C14Cal</code>, <code>Data_SigmaC14Cal</code>,
<code>Model_C14</code>, <code>CalibrationCurve</code>.</p>
<p>There are arguments for information concerning all the samples: <code>Nb_sample</code>, <code>SampleNames</code>, <code>SampleNature</code>,
<code>PriorAge</code>, <code>SavePdf</code>, <code>OutputFileName</code>, <code>OutputFilePath</code>, <code>SaveEstimates</code>, <code>OutputTableName</code>,
<code>OutputTablePath</code>, <code>StratiConstraints</code>, <code>sepSC</code>.<br /></p>
<p><b>** How to fill</b> <code>StratiConstraints</code> <b>? **</b><br /></p>
<p>If there is stratigraphic relations between samples, <b>14C estimate age in <code>Data_C14Cal</code> must be ordered by order of increasing ages,
as informations in <code>DATA</code></b>. Names in <code>SampleNames</code> must be ordered and corresponds to the order in <code>Data_C14Cal</code> and in <code>DATA</code>,
also if it is needed to mix names of OSL samples and 14C samples.</p>
<p>The user can fill the <code>StratiConstraints</code> matrix as follow.</p><ol>
<li><p><b>Size of the matrix</b>: row number of <code>StratiConstraints</code> matrix is equal to <code>Nb_sample+1</code>,
and column number is equal to <code>Nb_sample</code>.</p></li>
<li><p><b>First line of the matrix</b>:
for all <code>i in {1,...,Nb_Sample}</code>, <code>StratiConstraints[1,i]=1</code> that means the lower bound of the sample age (given in <code>PriorAge[2i-1]</code>)
for the sample whose number ID is equal to <code>i</code>, is taken into account.</p></li>
<li><p><b>Sample relations</b>: for all  <code>j in {2,...,Nb_Sample+1}</code> and all <code>i in {j,...,Nb_Sample}</code>,
<code>StratiConstraints[j,i]=1</code> if sample age whose number ID is equal to <code>j-1</code> is lower than sample age whose number ID is equal to <code>i</code>.
Otherwise, <code>StratiConstraints[j,i]=0</code>.</p></li>
</ol><p>Note that <code>StratiConstraints_{2:Nb_sample+1,1:Nb_sample}</code> is a upper triangular matrix.</p>
<p>The user can also use <code><a href='SCMatrix.html'>SCMatrix</a></code>  or <code><a href='SC_Ordered.html'>SC_Ordered</a></code> (if all samples are ordered) function to construc
the <code>StratiConstraints</code> matrix.</p>
<p>The user can also refer to a csv file that containts the relation between samples as defined above.
The user must take care about the separator used in the csv file using the argument <code>sepSC</code>.<br /></p>
<p><b>** How to fill</b> <code>THETA</code> <b>covariance matrix concerning common and individual error? **</b><br /></p>
<p>If systematic errors are considered, the user can fill the <code>THETA</code> matrix as follow.</p><ul>
<li><p>row number of <code>THETA</code> is equal the column number, equal to <code>Nb_sample</code>.</p></li>
<li><p>For all <code>i in {1,...,Nb_sample}</code>, <code>THETA[i,i]</code> containts individual error
plus systematic error of the sample whose number ID is equal to <code>i</code>.</p></li>
<li><p>For all <code>i,j in {1,...,Nb_sample}</code> and <code>i</code> different from <code>j</code> ,
<code>THETA[i,j]</code> contains common error between samples whose number ID are equal to <code>i</code> and <code>j</code>.</p></li>
</ul><p>Note that <code>THETA[i,j]</code> is a symmetric matrix.</p>
<p>The user can also refer to a .csv file that contains the errors as defined above.<br /></p>
<p><b>** Option on growth curves **</b><br /></p>
<p>As for <code><a href='Age_Computation.html'>Age_Computation</a></code> and <code><a href='Palaeodose_Computation.html'>Palaeodose_Computation</a></code>, the user can choose from 4 dose response curves:</p><ul>
<li><p><b>Saturating exponential plus linear growth</b> (<code>AgesMultiCS2_EXPLIN</code>):</p>
<p>for all <code>x</code> in IR+, <code>f(x)=a(1-exp(-x/b))+cx+d</code>; select</p><ul>
<li><p><code>LIN_fit=TRUE</code></p></li>
<li><p><code>Origin_fit=FALSE</code></p></li>
</ul></li>
<li><p><b>Saturating exponential growth</b> (<code>AgesMultiCS2_EXP</code>):</p>
<p>for all <code>x</code> in IR+, <code>f(x)=a(1-exp(-x/b))+d</code>; select</p><ul>
<li><p><code>LIN_fit=FALSE</code></p></li>
<li><p><code>Origin_fit=FALSE</code></p></li>
</ul></li>
<li><p><b>Saturating exponential plus linear growth and fitting through the origin</b> (<code>AgesMultiCS2_EXPLINZO</code>):</p>
<p>for all <code>x</code> in IR+, <code>f(x)=a(1-exp(-x/b))+cx</code>; select</p><ul>
<li><p><code>LIN_fit=TRUE</code></p></li>
<li><p><code>Origin_fit=TRUE</code></p></li>
</ul></li>
<li><p><b>Saturating exponential growth and fitting through the origin</b> (<code>AgesMultiCS2_EXPZO</code>):</p>
<p>for all <code>x</code> in IR+, <code>f(x)=a(1-exp(-x/b))</code>; select</p><ul>
<li><p><code>LIN_fit=FALSE</code></p></li>
<li><p><code>Origin_fit=TRUE</code></p></li>
</ul></li>
</ul>

<p><b>** Option on equivalent dose distribution around the palaeodose **</b><br /></p>
<p>The use can choose between :</p><ul>
<li><p><code>cauchy</code>: a Cauchy distribution with location parameter equal to the palaeodose of the sample</p></li>
<li><p><code>gaussian</code>: a Gaussian distribution with mean equal to the palaeodose of the sample</p></li>
<li><p><code>lognormal_A</code>: a log-normal distribution with mean or <b>A</b>verage equal to the palaeodose of the sample</p></li>
<li><p><code>lognormal_M</code>: a log-normal distribution with <b>M</b>edian equal to the palaeodose of the sample</p></li>
</ul>

<p><b>** More precision on <code>Model</code> **</b><br /></p>
<p>We propose two models "full" or "naive". If <code>Model='full'</code> that means measurement error and error on calibration curve are taken account in
the Bayesian model; if <code>Model="naive"</code> that means only error on measurement are taken account in the mode.</p>
<p>More precisely, the model considered here, as the one developped by Christen, JA (1994), assume multiplicative effect of errors to address the
problem of outliers. In addition, to not penalyse variables that are not outliers and damage theirs estimation,
we introduce a structure of mixture, that means only variable that are considered as outlier have in addition a multiplicative error.</p>
    <h2 class="hasAnchor" id="note"><a class="anchor" href="#note"></a>Note</h2>

    <p>Please note that the initial values for all MCMC are currently all the same for all chains since we rely on the automatic
initial value generation of JAGS. This is not optimal and will be changed in future. However, it does not affect the quality
of the age estimates if the chains have converged.</p>
    <h2 class="hasAnchor" id="how-to-cite"><a class="anchor" href="#how-to-cite"></a>How to cite</h2>

    <p>Christophe, C., Philippe, A., Guerin, G., Kreutzer, S., 2020. Age_OSLC14(): Bayesian analysis for age estimation of OSL measurements and C-14 ages of various samples. In: Christophe, C., Philippe, A., Kreutzer, S., Guerin, G., 2020. BayLum: Chronological Bayesian Models Integrating Optically Stimulated. R package version 0.2.0. https://CRAN.r-project.org/package=BayLum</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Reimer PJ, Bard E, Bayliss A, Beck JW, Blackwell PC, Bronl Ramsey C, Buck CE, Cheng H, Edwards RL, Friedrich M,
Grootes PM, Guilderson TP, Haflidason H, Hajdas I, Hatte C, Heaton TJ, Hoffmann DL, Hogg AG, Hughen KA, Kaiser KF, Kromer B,
Manning SW, Niu M, Reimer RW, Richards DA, Scott EM, Southon JR, Staff RA, Turney CSM, van der Plicht J. 2013.
IntCal13 ans Marine13 radiocarbon age calibration curves 0-50000 years cal BP. Radiocarbon 55(4)=1869-1887.</p>
<p>Hogg AG, Hua Q, Blackwell PG, Niu M, Buck CE, Guilderson TP, Heaton TJ, Palmer JG, Reimer PJ, Reimer RW, Turney CSM, Zimmerman SRH.
2013. SHCal13 Southern Hemisphere calibration, 0-50000 years cal BP. Radiocarbon 55(4):1889-1903</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p>rjags, <a href='plot_MCMC.html'>plot_MCMC</a>, <a href='SCMatrix.html'>SCMatrix</a>, <a href='plot_Ages.html'>plot_Ages</a></p></div>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Claire Christophe, Anne Philippe, Guillaume Guerin, Sebastian Kreutzer</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'>## Load data</span>
<span class='co'># OSL data</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>DATA1</span>,envir <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/environment.html'>environment</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>DATA2</span>,envir <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/environment.html'>environment</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>Data</span> <span class='op'>&lt;-</span> <span class='fu'><a href='combine_DataFiles.html'>combine_DataFiles</a></span><span class='op'>(</span><span class='va'>DATA2</span>,<span class='va'>DATA1</span><span class='op'>)</span>

<span class='co'># 14C data</span>
<span class='va'>C14Cal</span> <span class='op'>&lt;-</span> <span class='va'>DATA_C14</span><span class='op'>$</span><span class='va'>C14</span><span class='op'>[</span><span class='fl'>1</span>,<span class='fl'>1</span><span class='op'>]</span>
<span class='va'>SigmaC14Cal</span> <span class='op'>&lt;-</span> <span class='va'>DATA_C14</span><span class='op'>$</span><span class='va'>C14</span><span class='op'>[</span><span class='fl'>1</span>,<span class='fl'>2</span><span class='op'>]</span>
<span class='va'>Names</span> <span class='op'>&lt;-</span> <span class='va'>DATA_C14</span><span class='op'>$</span><span class='va'>Names</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span>

<span class='co'># Prior Age</span>
<span class='va'>prior</span><span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>,<span class='fl'>60</span><span class='op'>)</span>,<span class='fl'>3</span><span class='op'>)</span>
<span class='va'>samplenature</span><span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span>data<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>,<span class='fl'>0</span>,<span class='fl'>1</span>,<span class='fl'>0</span>,<span class='fl'>1</span>,<span class='fl'>0</span><span class='op'>)</span>,ncol<span class='op'>=</span><span class='fl'>3</span>,nrow<span class='op'>=</span><span class='fl'>2</span>,byrow<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>
<span class='va'>SC</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span>data<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>,<span class='fl'>1</span>,<span class='fl'>1</span>,<span class='fl'>0</span>,<span class='fl'>1</span>,<span class='fl'>1</span>,<span class='fl'>0</span>,<span class='fl'>0</span>,<span class='fl'>1</span>,<span class='fl'>0</span>,<span class='fl'>0</span>,<span class='fl'>0</span><span class='op'>)</span>,ncol<span class='op'>=</span><span class='fl'>3</span>,nrow<span class='op'>=</span><span class='fl'>4</span>,byrow<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>

<span class='co'>## Age computation of samples</span>
<span class='va'>Age</span> <span class='op'>&lt;-</span> <span class='fu'>Age_OSLC14</span><span class='op'>(</span>DATA<span class='op'>=</span><span class='va'>Data</span>,Data_C14Cal<span class='op'>=</span><span class='va'>C14Cal</span>,Data_SigmaC14Cal<span class='op'>=</span><span class='va'>SigmaC14Cal</span>,
   SampleNames<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"GDB5"</span>,<span class='va'>Names</span>,<span class='st'>"GDB3"</span><span class='op'>)</span>,Nb_sample<span class='op'>=</span><span class='fl'>3</span>,SampleNature<span class='op'>=</span><span class='va'>samplenature</span>,
   PriorAge<span class='op'>=</span><span class='va'>prior</span>,StratiConstraints<span class='op'>=</span><span class='va'>SC</span>,Iter<span class='op'>=</span><span class='fl'>50</span>,n.chains<span class='op'>=</span><span class='fl'>2</span><span class='op'>)</span>
</div><div class='output co'>#&gt; Compiling model graph
#&gt;    Resolving undeclared variables
#&gt;    Allocating nodes
#&gt; Graph information:
#&gt;    Observed stochastic nodes: 1446
#&gt;    Unobserved stochastic nodes: 1742
#&gt;    Total graph size: 49173
#&gt; 
#&gt; Initializing model
#&gt; </div><div class='output co'>#&gt; <span class='warning'>Warning: Adaptation incomplete</span></div><div class='output co'>#&gt; NOTE: Stopping adaptation
#&gt; 
#&gt; </div><div class='output co'>#&gt; <span class='warning'>Warning: [plot_MCMC()] 'n.iter' out of range, reset to number of observations</span></div><div class='img'><img src='Age_OSLC14-1.png' alt='' width='700' height='433' /></div><div class='img'><img src='Age_OSLC14-2.png' alt='' width='700' height='433' /></div><div class='img'><img src='Age_OSLC14-3.png' alt='' width='700' height='433' /></div><div class='output co'>#&gt; 
#&gt; 
#&gt; &gt;&gt; Convergence of MCMC for the age parameters &lt;&lt;
#&gt; ----------------------------------------------
#&gt; Sample name   Bayes estimate   Uppers credible interval
#&gt; A_GDB5 	 1.262 		 1.919 
#&gt; A_S-EVA-26510 	 1.008 		 1.013 
#&gt; A_GDB3 	 0.991 		 1.052 
#&gt; 
#&gt; 
#&gt; ________________________________________________________________________________
#&gt;  *** WARNING: following informations are only valid if MCMC chains converged  ***
#&gt; ________________________________________________________________________________
#&gt; 
#&gt; 
#&gt; &gt;&gt; Bayes estimates of Age for each sample and credible interval &lt;&lt;
#&gt; ------------------------------------------------------
#&gt; Sample name 	 Bayes estimate  Credible interval: 
#&gt; A_GDB5 	 7.565 
#&gt; 						 lower bound 	 upper bound
#&gt; 				 at level 95% 	 6.034 		 9.02 
#&gt; 				 at level 68% 	 6.576 		 7.964 
#&gt; ------------------------------------------------------
#&gt; Sample name 	 Bayes estimate  Credible interval: 
#&gt; A_S-EVA-26510 	 42 
#&gt; 						 lower bound 	 upper bound
#&gt; 				 at level 95% 	 41.68 		 42.287 
#&gt; 				 at level 68% 	 41.908 		 42.161 
#&gt; ------------------------------------------------------
#&gt; Sample name 	 Bayes estimate  Credible interval: 
#&gt; A_GDB3 	 46.63 
#&gt; 						 lower bound 	 upper bound
#&gt; 				 at level 95% 	 41.79 		 54.48 
#&gt; 				 at level 68% 	 42.43 		 46.733 
#&gt; 
#&gt; ------------------------------------------------------</div><div class='img'><img src='Age_OSLC14-4.png' alt='' width='700' height='433' /></div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Claire Christophe, Anne Philippe, Sebastian Kreutzer, Guillaume Guerin.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


